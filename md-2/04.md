# DOM事件

技术点：
- 基本概念：DOM事件的级别
- DOM事件模型（冒泡和捕获）
- DOM事件流
- 描述DOM事件捕获的具体流程
- Event对象的常见应用
- 自定义事件



事件级别：DOM标准定义的级别

- DOM0：  `element.onclick = function(){}`
- DOM1：  指定标准是没有涉及到事件相关的
- DOM2:   `element.addEventListener('click', function(){}, false)`
- DOM3:   `element.addEventListener('keyup', function(){}, false)`


事件模型
```
       捕获
        ->
事件流 ----- 目标阶段
        <-
        冒泡
```



描述DOM事件捕获的具体流程
```js
window
   |
   v
document
   |
   v
  html
   |
   v
  body
   |
   v
  ...
   |
   v
目标元素
```



Event对象的常见应用
```js
event.preventDefault()          // 阻止默认行为

event.stopPropagation()         // 阻止冒泡行为

event.stoplmmediatePropagation() // 注册的多事件，阻止往下继续执行；阻止剩余的事件处理函数的执行，并防止当前事件在DOM树上冒泡。

event.currentTarget             // 返回绑定事件的元素

event.target                    // 返回触发事件的元素
```

### 自定义事件（CustomEvent）

```js
event = new CustomEvent(type [, eventInitDict])
```
类似于 Event 事件的构造函数进行工作，除了可选的 eventInitDict 参数现在还允许设置 detail 属性。

```js
// 首先创建一个事件
let myEvent = new CustomEvent("userLogin", {
    detail: {
        username: "davidwalsh"
    }
});

// 触发它！
myElement.dispatchEvent(myEvent);
```

自定义(模拟)事件
```js
var eve = new Event('custome');
element.addEventListener('custome', function() {
    console.log('custome');
});
element.dispatchEvent(eve);
```


代码
```html
<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Event</title>
</head>

<body>
    <div id="ev">
        <style media="screen">
            #ev {
                width: 300px;
                height: 100px;
                background: red;
                color: #fff;
                text-align: center;
                line-height: 100px;
            }
        </style>
        目标元素
    </div>
    <script type="text/javascript">
        var ev = document.getElementById('ev');

        ev.addEventListener('click', function (e) {
            console.log('ev captrue');
        }, true);

        window.addEventListener('click', function (e) {
            console.log('window captrue');
        }, true);

        document.addEventListener('click', function (e) {
            console.log('document captrue');
        }, true);

        document.documentElement.addEventListener('click', function (e) {
            console.log('html captrue');
        }, true);

        document.body.addEventListener('click', function (e) {
            console.log('body captrue');
        }, true);

        var eve = new Event('test');
        ev.addEventListener('test', function () {
            console.log('test dispatch');
        });
        setTimeout(function () {
            ev.dispatchEvent(eve);
        }, 1000);
    </script>
</body>

</html>
```

