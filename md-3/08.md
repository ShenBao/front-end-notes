# hybird

```
移动端占大部分流量，已经远超PC
大多数公司都有自己的App
App中有大量前端代码
微信中有多少页面是前端的开发
```

目标
- Hybrid 是什么，为何要用
- Hybrid如何更新上线
- Hybrid和H5有何区别
- JS和Native通信


## Hybrid 是什么，为何要用

- Hybrid文字解释
- 存在价值，为何用
- webview
- file：//协议
- Hybrid实现流程


Hybrid文字解释
- Hybrid即为“混合”，即前端和客户端的混合开发
- 需前端开发和客户端配合完成
- noU型环节也涉及server端
- PS：不要以为自己是前端就不理会客户端和服务端的知识


Hybrid存在的价值
- 可以快速迭代更新【关键】(无需app审核)
- 体验流程(和NA体验基本一致)
- 减少开发和沟通成本，多端公用一套代码


webview
- 是app中的一个组件(app可以有webview，也可以没有)
- 用于加载h5页面，即一个小型的浏览器内核


file协议
- 双击html打开时，即使用了file协议
- 协议、标准的重要性

```
file:///ds/html/test.html
```

区别
- file协议：本地文件，快
- http(s):网络加载，慢


具体实现：
- 前端做好静态页面(html,js,css),将文件交给客户端
- 客户端拿到前端的静态页面，以文件形式存储于app中
- 客户端在一个webview中
- 使用file协议加载静态页面



注意：
- 不是所有的场景都适合用Hybrid
- 使用NA：体验要求极致，变化不频繁
- 使用hybrid：体验要求高，变化频繁
- 使用h5：体验无要求，不常用

## 更新上线

问题：
- app发布之后，静态文件如何实时更新
- 静态页面如何获取内容


更新流程：

- 要替换每个客户端的静态文件
- 只能客户端来做
- 客户端去server下载最新的静态文件
- 我们维护server的静态文件

```
server  <-  app
zip包(注意版本管理)       
```

完整流程：
- 分版本，有版本号
- 将静态文件压缩成zip包，上传到服务器端
- 客户端每次启动，都去服务器检查版本号
- 如果服务器版本号大于客户端版本号，就去下载最新的zip包
- 下载完成之后解压包，然后将现有文件覆盖


要点：
- 服务端的版本和zip维护
- 更新zip之前，先对比版本号
- zip下载解压和覆盖



## Hybrid和H5有何区别

优点：
- 体验更好，跟NA体验基本一致
- 可快速迭代，无需app审核


缺点：
- 开发成本高。联调、测试、查bug都比较麻烦
- 运维成本高（即上线更新）

使用场景
hybrid:产品的稳定功能，体验要求高，迭代频繁（适合产品型）
h5:单次的运营活动，不常用的功能（适合运营型）


## JS和Native通信

参考微信js-sdk










